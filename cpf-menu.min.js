!function(n){var e=n.module("module.cloudpayfull.menu",["ngCookies"]);e.directive("cpfMenu",function(){return{restrict:"EA",scope:{menuArray:"=",translateKey:"@",getUserInfo:"&"},template:'<div>   <ul class="nav">       <li class="dropdown" data-ng-repeat="menu in menuArray"           data-ng-class="{\'active\': (menu | CPFMenuActive), \'sub-menu\': (menu.menuList != null && menu.menuList.length > 0), \'toggled\': (menu | CPFMenuActive)}">           <a data-ng-if="menu.menuList == null || menu.menuList.length == 0"               ng-class="{\'active \': (menu | CPFMenuActive), \'sub-menu\': (menu.menuList != null && menu.menuList.length > 0) }"               data-ui-sref="{{menu.href}}"><i class="fa {{menu.icon}}"></i> {{translateKey ? ((\'menu.m_\' + menu[translateKey]) | CPFMenuTitle) : menu.menuTitle}}            </a>           <a data-ng-if="menu.menuList != null && menu.menuList.length > 0"                ng-class="{\'active\':(menu | CPFMenuActive), \'sub-menu\':(menu.menuList != null && menu.menuList.length > 0)}" toggle-submenu>               <i class="fa {{menu.icon}}"></i> {{translateKey ? ((\'menu.m_\' + menu[translateKey]) | CPFMenuTitle) : menu.menuTitle}}           </a>           <ul data-ng-if="menu.menuList != null && menu.menuList.length > 0" class="nav nav-second-level">               <li data-ng-repeat="sonMenu in menu.menuList">                    <a data-ui-sref="{{sonMenu.href}}" data-ng-click="sidebarStat($event)" ng-class="{\'active\': (sonMenu | CPFMenuActive)}">{{ translateKey ? ((\'menu.m_\' + sonMenu[translateKey]) | CPFMenuTitle) : sonMenu.menuTitle}}</a>               </li>           </ul>       </li>   </ul></div>',replace:!0,controller:["$scope","$rootScope","$cookies","$CPFMenu",function(e,a,i,r){var n;r.menuAreaArrayFlag||i.getObject(r.userInfoKey)&&(n={success:function(e){var n,t,u;e.platformInfoList.length<1||(n=r.getMenuList(e,e.platformInfoList[0].platCode),t=r.initMenuList(n,0),u=r.getDefaultMenu(t,i.getObject("menuInfo")),a.menuArray=u.menuList)}},e.getUserInfo({listener:n}))}]}}),e.directive("cpfAreaMenu",function(){return{restrict:"EA",scope:{menuAreaArray:"=",translateKey:"@",getUserInfo:"&"},template:"<ul class=\"pull-left\">   <li ng-class=\"{true: 'selected2', false: ''}[activeAreaMenuId == menu.menuId]\" ng-repeat=\"menu in menuAreaArray\">       <a href='' ng-click='changeMenu(menu)'>{{translateKey ? ('menu.m_' + menu[translateKey] | CPFMenuTitle) : menu.menuTitle}}</a>   </li></ul>",replace:!0,controller:["$scope","$rootScope","$cookies","$CPFMenu",function(u,a,i,r){var e;u.changeMenu=function(e){a.menuArray=e.menuList,u.activeAreaMenuId=e.menuId;var n=new Date;n.setDate(n.getDate()+r.cookiesDays),i.putObject("menuInfo",{bigMenuId:e.menuId},{expires:n})},r.menuAreaArrayFlag&&i.getObject(r.userInfoKey)&&(e={success:function(e){var n,t;e.platformInfoList.length<1||(n=r.getMenuList(e,e.platformInfoList[0].platCode),a.menuAreaArray=r.initMenuList(n,0),t=r.getDefaultMenu(a.menuAreaArray,i.getObject("menuInfo")),u.changeMenu(t))}},u.getUserInfo({listener:e}))}]}}),e.directive("toggleSubmenu",function(){return{restrict:"A",link:function(e,n){n.click(function(){var e=n.parent().hasClass("toggled");n.parent().parent().children().each(function(e){$(this).removeClass("toggled"),$(this).children("ul").css("display","none")}),e||(n.next().slideToggle(200),n.parent().toggleClass("toggled"))})}}}),e.provider("$CPFMenu",[function(){this.menuAreaArrayFlag=!0,this.userInfoKey="userInfo",this.cookiesDays=30,this.setConfig=function(e){n.extend(this,e)},this.getMenuList=function(e,n){for(var t=0;t<e.platformInfoList.length;t++){var u=e.platformInfoList[t];if(u.platCode==n)return u.menuList}return[]},this.initMenuList=function(e,n){var t=[];if(null==e||e.length<1)return t;for(var u=0;u<e.length;u++){var a=e[u];a.parentMenuId==n&&(a.menuList=this.initMenuList(e,a.menuId),t.push(a))}return t.length<1?void 0:t},this.getDefaultMenu=function(e,n){if(e){null!=n&&null!=n.bigMenuId||(n={bigMenuId:e[0].menuId});for(var t=void 0,u=0;u<e.length;u++)if(e[u].menuId==n.bigMenuId){t=e[u];break}return t}},this.$get=function(){return this}}]),e.filter("CPFMenuTitle",["$injector",function(e){function n(e){return t?t.instant(e):e}var t=e.has("$translate")?e.get("$translate"):void 0;return n.$stateful=!0,n}]),e.filter("CPFMenuActive",["$state",function(n){function e(e){return!(""==e.href||!n.includes(e.href))||null!=e.showFlag&&1<e.showFlag.length&&0<=n.current.name.indexOf(e.showFlag)}return e.$stateful=!0,e}])}(angular);