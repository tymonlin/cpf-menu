!function(n){var e=n.module("module.cloudpayfull.menu",["ngCookies"]);e.directive("cpfMenu",function(){return{restrict:"EA",scope:{menuArray:"=",translateKey:"@",sidebarType:"@",getUserInfo:"&"},template:'<div>   <ul ng-show="sidebarType != \'miniBar\'" class="nav nav-default">       <li class="dropdown" data-ng-repeat="menu in menuArray"           data-ng-class="{\'active\': (menu | CPFMenuActive), \'toggled\': (menu | CPFMenuActive)}">           <a data-ng-if="!menu.menuList"               ng-class="{\'active \': (menu | CPFMenuActive)}"               data-ui-sref="{{menu.href}}"><i class="fa {{menu.icon}}"></i> <label class=\'menu-title\'>{{translateKey ? ((\'menu.m_\' + menu[translateKey]) | CPFMenuTitle) : menu.menuTitle}}</label>            </a>           <a data-ng-if="menu.menuList"                ng-class="{\'active\':(menu | CPFMenuActive)}" toggle-submenu>               <i class="fa {{menu.icon}}"></i> <label class=\'menu-title\'>{{translateKey ? ((\'menu.m_\' + menu[translateKey]) | CPFMenuTitle) : menu.menuTitle}}</label>           </a>           <ul data-ng-if="menu.menuList != null && menu.menuList.length > 0" class="nav">               <li data-ng-repeat="sonMenu in menu.menuList">                    <a data-ui-sref="{{sonMenu.href}}" data-ng-click="sidebarStat($event)" ng-class="{\'active\': (sonMenu | CPFMenuActive)}"> <label class=\'menu-title\'>{{ translateKey ? ((\'menu.m_\' + sonMenu[translateKey]) | CPFMenuTitle) : sonMenu.menuTitle}}</label> </a>               </li>           </ul>       </li>   </ul>   <ul ng-show="sidebarType == \'miniBar\'" class="nav mini-bar">       <li data-ng-repeat="menu in menuArray" data-ng-class="{\'active\': (menu | CPFMenuActive)}" title="{{ translateKey ? ((\'menu.m_\' + menu[translateKey]) | CPFMenuTitle) : menu.menuTitle}}">           <a data-ng-if="!menu.menuList" ng-class="{\'active \': (menu | CPFMenuActive)}" data-ui-sref="{{menu.href}}">               <i class="fa {{menu.icon}}"></i>           </a>           <a data-ng-if="menu.menuList" ng-class="{\'active \': (menu | CPFMenuActive)}"                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" dropdown-toggle>               <i class="fa {{menu.icon}}"></i>           </a>           <ul class="dropdown-menu nav">               <li data-ng-repeat="sonMenu in menu.menuList" data-ng-class="{\'active\': (menu | CPFMenuActive)}">                    <a data-ui-sref="{{sonMenu.href}}" data-ng-click="sidebarStat($event)" ng-class="{\'active\': (sonMenu | CPFMenuActive)}"> '+"                       <label class='menu-title'>{{ translateKey ? (('menu.m_' + sonMenu[translateKey]) | CPFMenuTitle) : sonMenu.menuTitle}}</label>                   </a>               </li>           </ul>       </li>   </ul></div>",replace:!0,controller:["$scope","$rootScope","$cookies","$CPFMenu",function(e,u,i,s){var n;s.menuAreaArrayFlag||i.getObject(s.userInfoKey)&&(n={success:function(e){var n,t,a;e.platformInfoList.length<1||(n=s.getMenuList(e,e.platformInfoList[0].platCode),t=s.initMenuList(n,0),a=s.getDefaultMenu(t,i.getObject("menuInfo")),u.menuArray=a.menuList)}},e.getUserInfo({listener:n}))}]}}),e.directive("cpfAreaMenu",function(){return{restrict:"EA",scope:{menuAreaArray:"=",translateKey:"@",getUserInfo:"&"},template:"<ul class=\"nav navbar-nav navbar-left\">   <li ng-class=\"{true: 'selected2', false: ''}[activeAreaMenuId == menu.menuId]\" ng-repeat=\"menu in menuAreaArray\">       <a href='' ng-click='changeMenu(menu)'>{{translateKey ? ('menu.m_' + menu[translateKey] | CPFMenuTitle) : menu.menuTitle}}</a>   </li></ul>",replace:!0,controller:["$scope","$rootScope","$cookies","$CPFMenu",function(a,u,i,s){var e;a.changeMenu=function(e){u.menuArray=e.menuList,a.activeAreaMenuId=e.menuId;var n=new Date;n.setDate(n.getDate()+s.cookiesDays),i.putObject("menuInfo",{bigMenuId:e.menuId},{expires:n})},s.menuAreaArrayFlag&&i.getObject(s.userInfoKey)&&(e={success:function(e){var n,t;e.platformInfoList.length<1||(n=s.getMenuList(e,e.platformInfoList[0].platCode),u.menuAreaArray=s.initMenuList(n,0),t=s.getDefaultMenu(u.menuAreaArray,i.getObject("menuInfo")),a.changeMenu(t))}},a.getUserInfo({listener:e}))}]}}),e.directive("toggleSubmenu",function(){return{restrict:"A",link:function(e,n){$(n).addClass("menu"),n.click(function(){var e=n.parent().hasClass("toggled");n.parent().parent().children().each(function(e){$(this).removeClass("toggled"),$(this).children("ul").css("display","none")}),e||(n.next().slideToggle(200),n.parent().toggleClass("toggled"))})}}}),e.directive("dropdownToggle",function(){return{restrict:"A",link:function(e,n){$(n).addClass("dropdown-toggle"),$(n).dropdown()}}}),e.provider("$CPFMenu",[function(){this.menuAreaArrayFlag=!0,this.userInfoKey="userInfo",this.cookiesDays=30,this.setConfig=function(e){n.extend(this,e)},this.getMenuList=function(e,n){for(var t=0;t<e.platformInfoList.length;t++){var a=e.platformInfoList[t];if(a.platCode==n)return a.menuList}return[]},this.initMenuList=function(e,n){var t=[];if(null==e||e.length<1)return t;for(var a=0;a<e.length;a++){var u=e[a];u.parentMenuId==n&&(u.menuList=this.initMenuList(e,u.menuId),t.push(u))}return t.length<1?void 0:t},this.getDefaultMenu=function(e,n){if(e){null!=n&&null!=n.bigMenuId||(n={bigMenuId:e[0].menuId});for(var t=void 0,a=0;a<e.length;a++)if(e[a].menuId==n.bigMenuId){t=e[a];break}return t}},this.$get=function(){return this}}]),e.filter("CPFMenuTitle",["$injector",function(e){function n(e){return t?t.instant(e):e}var t=e.has("$translate")?e.get("$translate"):void 0;return n.$stateful=!0,n}]),e.filter("CPFMenuActive",["$state",function(n){function e(e){return!(""==e.href||!n.includes(e.href))||null!=e.showFlag&&1<e.showFlag.length&&0<=n.current.name.indexOf(e.showFlag)}return e.$stateful=!0,e}])}(angular);